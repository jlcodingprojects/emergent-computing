<Window x:Class="EmergentComputing.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:skia="clr-namespace:SkiaSharp.Views.WPF;assembly=SkiaSharp.Views.WPF"
        mc:Ignorable="d"
        Title="Emergent Computing Simulator" Height="800" Width="1400"
        Background="#1a1a1a"
        KeyDown="Window_KeyDown">
    <TabControl x:Name="MainTabControl" Background="#1a1a1a" BorderThickness="0">
        <TabControl.Resources>
            <Style TargetType="TabItem">
                <Setter Property="Background" Value="#2a2a2a"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="Padding" Value="20,10"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border Name="Border" Background="{TemplateBinding Background}" 
                                    BorderThickness="0,0,0,2" BorderBrush="Transparent"
                                    Padding="{TemplateBinding Padding}" Margin="0,0,2,0">
                                <ContentPresenter ContentSource="Header" 
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#1a1a1a"/>
                                    <Setter TargetName="Border" Property="BorderBrush" Value="#4a9eff"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#333333"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </TabControl.Resources>
        
        <!-- EXPERIMENT TAB -->
        <TabItem x:Name="ExperimentTab" Header="Experiment">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="350"/>
                </Grid.ColumnDefinitions>

                <!-- Main Visualization Area -->
                <Border Grid.Column="0" Background="#0a0a0a" BorderBrush="#333" BorderThickness="0,0,1,0">
                    <skia:SKElement x:Name="SimulationCanvas" />
                </Border>

                <!-- Control Panel -->
                <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" Background="#2a2a2a">
                    <StackPanel Margin="10">
                        <!-- Title -->
                        <TextBlock Text="Emergent Computing" FontSize="20" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                
                <!-- Configuration Section -->
                <GroupBox Header="Configuration" Foreground="White" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Select Configuration:" Foreground="White"/>
                        <ComboBox x:Name="ConfigSelect" SelectionChanged="ConfigSelect_SelectionChanged" Margin="0,5,0,5"/>
                        <Button x:Name="BtnRandomConfig" Content="Random Config" Click="BtnRandomConfig_Click"/>
                        
                        <Border Background="#333" Padding="5" Margin="0,10,0,0" CornerRadius="3">
                            <StackPanel x:Name="ConfigInfo">
                                <TextBlock x:Name="ConfigName" Text="Configuration Name" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="ConfigDescription" Text="Description" Foreground="#aaa" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                <StackPanel x:Name="ConfigDetails" Margin="0,5,0,0">
                                    <TextBlock Foreground="#aaa"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <!-- Simulation Controls -->
                <GroupBox Header="Simulation Controls" Foreground="White" Margin="0,0,0,10">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="BtnStart" Content="Start" Click="BtnStart_Click" Width="60"/>
                            <Button x:Name="BtnPause" Content="Pause" Click="BtnPause_Click" Width="60"/>
                            <Button x:Name="BtnReset" Content="Reset" Click="BtnReset_Click" Width="60"/>
                            <Button x:Name="BtnStep" Content="Step" Click="BtnStep_Click" Width="60"/>
                        </StackPanel>
                        
                        <TextBlock Text="Speed:" Foreground="White" Margin="0,10,0,5"/>
                        <Slider x:Name="SpeedControl" Minimum="1" Maximum="100" Value="50" ValueChanged="SpeedControl_ValueChanged"/>
                        <TextBlock x:Name="SpeedLabel" Text="Speed: 1x" Foreground="#aaa"/>
                    </StackPanel>
                </GroupBox>

                <!-- Visualization Options -->
                <GroupBox Header="Visualization" Foreground="White" Margin="0,0,0,10">
                    <StackPanel>
                        <CheckBox x:Name="ChkShowVelocity" Content="Show Velocity" Foreground="White" Checked="ChkShowVelocity_Changed" Unchecked="ChkShowVelocity_Changed"/>
                        <CheckBox x:Name="ChkShowSenseRadius" Content="Show Sense Radius" Foreground="White" Checked="ChkShowSenseRadius_Changed" Unchecked="ChkShowSenseRadius_Changed"/>
                    </StackPanel>
                </GroupBox>

                <!-- Statistics -->
                <GroupBox Header="Statistics" Foreground="White" Margin="0,0,0,10">
                    <StackPanel x:Name="SimulationStats">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Tick:" Foreground="White" Margin="0,2"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="StatTick" Text="0" Foreground="#aaa" Margin="5,2" HorizontalAlignment="Right"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Particles:" Foreground="White" Margin="0,2"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="StatParticles" Text="0" Foreground="#aaa" Margin="5,2" HorizontalAlignment="Right"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Complexity:" Foreground="White" Margin="0,2"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" x:Name="StatComplexity" Text="0.000" Foreground="#aaa" Margin="5,2" HorizontalAlignment="Right"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Clustering:" Foreground="White" Margin="0,2"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" x:Name="StatClustering" Text="0.000" Foreground="#aaa" Margin="5,2" HorizontalAlignment="Right"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Movement:" Foreground="White" Margin="0,2"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" x:Name="StatMovement" Text="0.000" Foreground="#aaa" Margin="5,2" HorizontalAlignment="Right"/>
                        </Grid>

                        <TextBlock Text="State Distribution:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                        <ItemsControl x:Name="StateDistributionList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="{Binding Key}" Foreground="White"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Value}" Foreground="#aaa" Margin="5,0,0,0"/>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </TabItem>
        
        <!-- TRIALS TAB -->
        <TabItem x:Name="TrialsTab" Header="Trials">
            <Grid Background="#1a1a1a">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Trial Configuration Panel -->
                <Border Grid.Row="0" Background="#2a2a2a" BorderBrush="#333" BorderThickness="0,0,0,1" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Trial Configuration" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,15"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                <TextBlock Text="Configuration:" Foreground="White" Margin="0,0,0,5"/>
                                <ComboBox x:Name="TrialConfigSelect" SelectionChanged="TrialConfigSelect_SelectionChanged"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="0,0,20,0">
                                <TextBlock Text="Trial Duration (ms):" Foreground="White" Margin="0,0,0,5"/>
                                <TextBox x:Name="TrialDuration" Text="5000"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Number of Trials:" Foreground="White" Margin="0,0,0,5"/>
                                <TextBox x:Name="NumTrials" Text="10"/>
                            </StackPanel>
                        </Grid>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                            <Button x:Name="BtnRunTrial" Content="Run Single Trial" Click="BtnRunTrial_Click" Width="120" Margin="0,0,10,0"/>
                            <Button x:Name="BtnRunBatch" Content="Run Batch Trials" Click="BtnRunBatch_Click" Width="120" Margin="0,0,10,0"/>
                            <Button x:Name="BtnClearTrials" Content="Clear Trials" Click="BtnClearTrials_Click" Width="120"/>
                        </StackPanel>
                        
                        <StackPanel Margin="0,15,0,0">
                            <ProgressBar x:Name="TrialProgress" Height="25" Minimum="0" Maximum="100"/>
                            <TextBlock x:Name="ProgressText" Text="0 / 0" Foreground="#aaa" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Trial Results List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="TrialResultsPanel" Margin="20">
                        <TextBlock Text="No trials completed yet" Foreground="#aaa" FontSize="14"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </TabItem>
    </TabControl>
</Window>

